<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>music21.analysis.floatingKey &mdash; music21 Documentation</title>
    
    <link rel="stylesheet" href="../_static/m21.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="top" title="music21 Documentation" href="../index.html" />
    <link rel="up" title="Module Reference" href="index.html" />
    <link rel="next" title="music21.analysis.metrical" href="moduleAnalysisMetrical.html" />
    <link rel="prev" title="music21.analysis.discrete" href="moduleAnalysisDiscrete.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
<script src='http://artusi.xyz/music21j/ext/require/require.js'></script>
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="moduleAnalysisMetrical.html" title="music21.analysis.metrical"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="moduleAnalysisDiscrete.html" title="music21.analysis.discrete"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">music21</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module Reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="moduleAnalysisDiscrete.html"
                        title="previous chapter">music21.analysis.discrete</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="moduleAnalysisMetrical.html"
                        title="next chapter">music21.analysis.metrical</a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">music21.analysis.floatingKey</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#keyanalyzer">KeyAnalyzer</a></li>
</ul>
</li>
</ul>

<h3><a href="../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About Music21</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usersGuide/index.html">User&#8217;s Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Module Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installing/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developerReference/index.html">Developer Reference</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/moduleReference/moduleAnalysisFloatingKey.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="music21-analysis-floatingkey">
<span id="moduleanalysisfloatingkey"></span><h1>music21.analysis.floatingKey<a class="headerlink" href="#music21-analysis-floatingkey" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-music21.analysis.floatingKey"></span><p>The floatingKey analyzer will give an approximation of the key at any point in
a score down to the measure level using a fixed window.  It helps smooth out
measures emphasizing non-chord tones, etc.</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="music21.analysis.floatingKey.divide">
<code class="descclassname">music21.analysis.floatingKey.</code><code class="descname">divide</code><span class="sig-paren">(</span><em>coefficient</em>, <em>distance</em><span class="sig-paren">)</span><a class="headerlink" href="#music21.analysis.floatingKey.divide" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide the coefficient by the absolute value of the distance + 1</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">analysis</span><span class="o">.</span><span class="n">floatingKey</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="keyanalyzer">
<h2>KeyAnalyzer<a class="headerlink" href="#keyanalyzer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="music21.analysis.floatingKey.KeyAnalyzer">
<em class="property">class </em><code class="descclassname">music21.analysis.floatingKey.</code><code class="descname">KeyAnalyzer</code><span class="sig-paren">(</span><em>s=None</em><span class="sig-paren">)</span><a class="headerlink" href="#music21.analysis.floatingKey.KeyAnalyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>KeyAnalyzer is the main object to use for floating analysis.</p>
<p>The <cite>windowSize</cite> attribute (default 4) determines how many measures to look at in making
the decision.  Make it larger for pieces (like Mozart sonatas) that you expect fewer key
changes.  Make it smaller for pieces (like Bach chorales) that you expect more key changes.
Or set it to an integer based on the number of the measures in the piece.</p>
<p>The <cite>weightAlgorithm</cite> attribute determines how to scale the weight of measures according to
their distance.  Currently only one algorithm is supported: floatingKey.divide.</p>
<p>TODO: Needs more work to work with second endings, partial measures, etc.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;bwv66.6&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ka</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">floatingKey</span><span class="o">.</span><span class="n">KeyAnalyzer</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ka</span><span class="o">.</span><span class="n">windowSize</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># chorale uses quick key changes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ka</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>  <span class="c1"># first measure is the pickup</span>
<span class="go">[&lt;music21.key.Key of A major&gt;, &lt;music21.key.Key of A major&gt;, &lt;music21.key.Key of A major&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;]</span>
</pre></div>
</div>
<p>Raw analysis (no smoothing):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ka</span><span class="o">.</span><span class="n">getRawKeyByMeasure</span><span class="p">()</span>
<span class="go">[&lt;music21.key.Key of A major&gt;, &lt;music21.key.Key of E major&gt;, &lt;music21.key.Key of A major&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of E major&gt;, &lt;music21.key.Key of A major&gt;, </span>
<span class="go"> &lt;music21.key.Key of b minor&gt;, &lt;music21.key.Key of C# major&gt;, </span>
<span class="go"> &lt;music21.key.Key of F# major&gt;, &lt;music21.key.Key of b minor&gt;]</span>
</pre></div>
</div>
<p>Major smoothing...</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ka</span><span class="o">.</span><span class="n">windowSize</span> <span class="o">=</span> <span class="n">ka</span><span class="o">.</span><span class="n">numMeasures</span> <span class="o">//</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ka</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>  <span class="c1"># only the pickup seems to be in A major by this approach</span>
<span class="go">[&lt;music21.key.Key of A major&gt;, &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;, </span>
<span class="go"> &lt;music21.key.Key of f# minor&gt;, &lt;music21.key.Key of f# minor&gt;]</span>
</pre></div>
</div>
</dd></dl>

<p class="rubric"><a class="reference internal" href="#music21.analysis.floatingKey.KeyAnalyzer" title="music21.analysis.floatingKey.KeyAnalyzer"><code class="xref py py-class docutils literal"><span class="pre">KeyAnalyzer</span></code></a> methods</p>
<dl class="method">
<dt id="music21.analysis.floatingKey.KeyAnalyzer.getInterpretationByMeasure">
<code class="descclassname">KeyAnalyzer.</code><code class="descname">getInterpretationByMeasure</code><span class="sig-paren">(</span><em>mNumber</em><span class="sig-paren">)</span><a class="headerlink" href="#music21.analysis.floatingKey.KeyAnalyzer.getInterpretationByMeasure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of interpretations for the measure.</p>
</dd></dl>

<dl class="method">
<dt id="music21.analysis.floatingKey.KeyAnalyzer.getRawKeyByMeasure">
<code class="descclassname">KeyAnalyzer.</code><code class="descname">getRawKeyByMeasure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#music21.analysis.floatingKey.KeyAnalyzer.getRawKeyByMeasure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="music21.analysis.floatingKey.KeyAnalyzer.run">
<code class="descclassname">KeyAnalyzer.</code><code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#music21.analysis.floatingKey.KeyAnalyzer.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="music21.analysis.floatingKey.KeyAnalyzer.smoothInterpretationByMeasure">
<code class="descclassname">KeyAnalyzer.</code><code class="descname">smoothInterpretationByMeasure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#music21.analysis.floatingKey.KeyAnalyzer.smoothInterpretationByMeasure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="moduleAnalysisMetrical.html" title="music21.analysis.metrical"
             >next</a> |</li>
        <li class="right" >
          <a href="moduleAnalysisDiscrete.html" title="music21.analysis.discrete"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">music21</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006-2016, Michael Scott Cuthbert and cuthbertLab.
      Last updated on Aug 21, 2016.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>